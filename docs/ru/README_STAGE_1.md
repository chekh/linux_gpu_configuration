# Скрипты настройки удалённого доступа

Этот раздел репозитория содержит скрипты, предназначенные для настройки и управления удалённым доступом к Linux-машине с использованием RDP (через `xrdp`) и VNC. Скрипты позволяют установить, настроить и управлять этими сервисами, а также очистить и удалить их при необходимости.

## Оглавление

- [Обзор](#обзор)
- [Установка](#установка)
- [Удаление](#удаление)
- [Управление сервисами](#управление-сервисами)
- [Проверка состояния сервисов](#проверка-состояния-сервисов)
- [Конфигурация](#конфигурация)

## Обзор

Скрипты в этом каталоге предназначены для настройки служб RDP и VNC на Linux-машине. Они поддерживают следующие функции:

- **Настройка RDP:** Установка и настройка `xrdp` с использованием заданной рабочей среды.
- **Настройка VNC:** Установка и настройка `tightvncserver` с использованием заданной рабочей среды.
- **Управление сервисами:** Включение, отключение, запуск, остановка и перезапуск сервисов в зависимости от конфигурации.
- **Очистка окружения:** Безопасное удаление установленных сервисов и связанных конфигураций без нарушения работы стандартной рабочей среды.

## Установка

### 1. Настройте окружение

Перед запуском любых установочных скриптов убедитесь, что настроили файл конфигурации `config.env`. Этот файл определяет, какие сервисы нужно установить и какую рабочую среду использовать. Пример конфигурации приведён ниже:

```ini
# config.env

# Конфигурация VNC
VNC_ENABLE=false
VNC_PORT=5901
VNC_PASSWORD="your_secure_password"

# Конфигурация RDP
RDP_ENABLE=true
RDP_PORT=3389

# Конфигурация оконного менеджера
WINDOW_MANAGER="xfce"  # Поддерживаются: xfce, gnome, kde, cinnamon, mate, mint

# Очистка предыдущего оконного менеджера перед установкой нового
CLEAR_PREVIOUS_WM=true
```

### 2. Запустите установочные скрипты

Чтобы установить и настроить RDP:

```bash
./install_rdp.sh
```

Чтобы установить и настроить VNC:

```bash
./install_vnc.sh
```

Оба скрипта автоматически настроят сервисы на основе параметров из файла `config.env`. Они также предотвратят удаление стандартной рабочей среды, если параметр `CLEAR_PREVIOUS_WM` установлен в `true`.

### 3. Проверьте состояние сервисов

После установки вы можете проверить состояние сервисов с помощью команды:

```bash
./check_service_status.sh
```

Этот скрипт отобразит статус сервисов `xrdp`, `xrdp-sesman` и `vncserver` (если включён VNC).

## Удаление

Чтобы удалить все установленные компоненты и очистить конфигурации, выполните скрипт удаления:

```bash
./uninstall_stage_1.sh
```

Этот скрипт безопасно удалит все установленные сервисы и их конфигурации, сохранив стандартную рабочую среду.

## Управление сервисами

Вы можете управлять сервисами RDP и VNC с помощью скрипта `manage_services.sh`. Этот скрипт позволяет запускать, останавливать, перезапускать или отключать сервисы в зависимости от текущей конфигурации в файле `config.env`.

Для управления сервисами выполните:

```bash
./manage_services.sh
```

Скрипт автоматически управляет сервисами на основе настроек `RDP_ENABLE` и `VNC_ENABLE` в файле `config.env`.

## Проверка состояния сервисов

Чтобы проверить статус всех ключевых сервисов, выполните следующий скрипт:

```bash
./check_service_status.sh
```

Этот скрипт выведет текущее состояние сервисов `xrdp`, `xrdp-sesman` и `vncserver` (если включён VNC).

## Конфигурация

Поведение скриптов контролируется файлом `config.env`. Измените этот файл, чтобы настроить, какие сервисы будут включены, какую рабочую среду использовать и нужно ли очищать предыдущие настройки оконного менеджера.

### Пример конфигурации

```ini
# Включить RDP и отключить VNC
RDP_ENABLE=true
VNC_ENABLE=false

# Использовать XFCE в качестве рабочей среды
WINDOW_MANAGER="xfce"

# Очистить настройки предыдущей рабочей среды
CLEAR_PREVIOUS_WM=true
```

Измените этот файл в соответствии с вашими потребностями перед запуском установочных или управляющих скриптов.

## Заключение

Эти скрипты предоставляют комплексное решение для управления удалённым доступом к вашей Linux-машине через RDP и VNC. Убедитесь, что файл `config.env` настроен в соответствии с вашими требованиями перед выполнением скриптов.

Если у вас возникнут проблемы или вам потребуется дополнительная настройка, обратитесь к комментариям в скриптах или за помощью в сообществе.

---